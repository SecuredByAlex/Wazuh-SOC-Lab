# üõ°Ô∏è Lab 3: Vulnerability Detection (Automated CVE Scanning)
**Goal:** Configure Wazuh to automatically detect known vulnerabilities (CVEs) in the software installed on the Kali Linux Agent.

---

## üîπ Part 1: Server-Side Configuration (Wazuh Manager)
*Enable the Vulnerability Detector module to download CVE databases.*

1. **Access the Manager Config:**
* Open the Wazuh Manager configuration file:
bash
sudo nano /var/ossec/etc/ossec.conf
2. **Enable the Module:**
* Locate the `<vulnerability-detector>` block.
* Set `<enabled>` to `yes`.
* Ensure the OS providers (Canonical, Debian, RedHat, NVD) are enabled.
* *Example Configuration:*
```bash
<vulnerability-detector>
<enabled>yes</enabled>
<interval>5m</interval>
<min_full_scan_interval>6h</min_full_scan_interval>
<run_on_start>yes</run_on_start>

......

</vulnerability-detector>
```
3. **Restart Manager:**
```bash
sudo systemctl restart wazuh-manager
```
*(Note: It may take several minutes for the manager to download the CVE databases).*

<img width="1920" height="1080" alt="Image" src="https://github.com/user-attachments/assets/2fbb3fdd-febb-4747-b5e2-45050d2c0c69" />

---

## üîπ Part 2: Agent Configuration
*Ensure the Agent is reporting its software inventory.*

1. **Check `ossec.conf` on Agent:**
* By default, the `syscollector` module (which gathers software info) is enabled.
* You can verify this in the Agent's config file:
```bash
<wodle name="syscollector">
<disabled>no</disabled>
<interval>1h</interval>
<scan_on_start>yes</scan_on_start>
<hardware>yes</hardware>
<os>yes</os>
<network>yes</network>
<packages>yes</packages>
</wodle>
```
<img width="1920" height="1080" alt="Image" src="https://github.com/user-attachments/assets/88a008f2-7c3a-4653-be8b-164080e6b072" />
---

## üîπ Part 3: Verification & Results
*Analyze the detected vulnerabilities.*

1. **Trigger the Scan:**
* Restart the Wazuh Agent to force a "scan on start" inventory check:
```bash
sudo systemctl restart wazuh-agent
```
2. **Check Wazuh Dashboard:**
* Navigate to **Modules > Vulnerability Detection**.
* **Result:** The dashboard displays a summary of affected packages.
* **Findings:**
* **Total Vulnerabilities:** 9 Critical, 556 High.
* **Top Affected Packages:** * `Django` (Remote Code Execution risk)
* `Jinja2` (Template injection risk)
* `redis` (Database vulnerabilities)
* **Target System:** Kali GNU/Linux 2024.4

<img width="1920" height="1080" alt="Image" src="https://github.com/user-attachments/assets/62d49e63-de85-49d4-823c-f7ee01ddc575" /><br>
<img width="1920" height="1080" alt="Image" src="https://github.com/user-attachments/assets/8cb48e4e-2250-43ac-91b2-8d3d32096720" />

